@Immutable 어노테이션을 사용하는 이유는 Jetpack Compose에서 효율적인 상태 관리를 보장하기 위해서입니다. @Immutable을 사용하면 Compose에서 객체의 변경 가능성을 명시적으로 알려주기 때문에, 불필요한 UI 리렌더링을 방지하고 성능을 최적화할 수 있습니다.

Compose는 상태가 변경되면 UI를 다시 그리기 때문에, 변경되지 않은 상태에서 불필요한 UI 갱신이 발생하면 성능 저하로 이어질 수 있습니다. @Immutable 어노테이션을 붙이면 Compose가 해당 객체가 변경 불가능하다는 것을 알게 되어, 불필요한 리렌더링을 방지할 수 있습니다.

@Immutable이란?

@Immutable 어노테이션은 해당 클래스가 불변(immutable)임을 보장하는 메타데이터입니다. 이 클래스의 모든 프로퍼티가 val로 선언되어야 하며, 해당 객체가 생성된 이후에는 상태가 변경되지 않는다는 의미입니다.

Jetpack Compose에서 상태 관리와 관련해 중요한 사항은, Compose가 상태가 변경되었을 때만 화면을 다시 렌더링한다는 점입니다. 따라서 Compose는 객체가 불변임을 알면, 객체 내부 값이 바뀔 가능성이 없으므로 그 객체를 다시 확인할 필요가 없다고 판단합니다.

왜 @Immutable을 붙이면 좋은가?

	1.	불필요한 리렌더링 방지:
	•	Compose는 객체가 변경되었다고 판단되면 해당 객체를 사용하는 UI 컴포넌트를 다시 렌더링합니다. 하지만 객체가 불변인 경우에는 객체 내부 상태가 변경될 일이 없기 때문에, 불필요한 UI 업데이트를 방지할 수 있습니다.
	•	@Immutable을 통해 Compose에게 이 객체는 불변임을 알려주면, 객체가 변경되지 않았음을 확실히 하고 리렌더링을 피할 수 있습니다.
	2.	컴파일 타임 안전성 보장:
	•	@Immutable은 컴파일 타임에 객체의 불변성을 보장하도록 도와줍니다. 객체가 실제로 불변하지 않으면 컴파일 오류가 발생하게 되므로, 개발자는 객체의 상태 변경 가능성을 미리 알 수 있습니다.
	•	예를 들어, var가 있거나, 불변이 아닌 다른 클래스를 포함하고 있으면 컴파일러가 이를 잡아낼 수 있습니다.
	3.	효율적인 상태 관리:
	•	Compose에서 상태는 불변일수록 관리가 용이합니다. 상태 변경이 없다는 것을 확실히 알 수 있기 때문에, 필요하지 않은 부분에 대해 상태 변경을 처리할 필요가 없고, 상태 변경이 필요한 부분에만 집중할 수 있습니다.
	4.	메모리 최적화:
	•	불변 객체는 객체를 복사해서 사용하거나 캐싱하는 데 유리합니다. 불변 객체는 생성 후 변경되지 않으므로, 메모리 누수 등의 문제를 예방하는 데 도움을 줄 수 있습니다.

@Immutable과 @Stable의 차이점

	•	@Immutable: 클래스의 모든 속성들이 불변(val)이며, 포함된 속성들 또한 모두 불변인 경우에 사용됩니다. 즉, 그 클래스의 상태가 절대 변경되지 않음을 보장합니다.
	•	@Stable: 클래스 자체는 변경 가능하더라도, 상태가 변경될 때 Compose가 이를 효율적으로 감지할 수 있음을 나타냅니다. 상태가 변경될 때 Compose는 이를 캐싱하거나 변경을 최소화할 수 있습니다.

예시

1. @Immutable을 붙이지 않은 경우:
2. 
이 경우 LoginState가 변경되지 않았더라도 Compose는 이를 다시 렌더링할 가능성이 있습니다. 왜냐하면 이 객체가 변경될 가능성을 고려해야 하기 때문입니다.

2. @Immutable을 붙인 경우:

```
@Immutable
data class LoginState(
    val id: String = "",
    val password: String = ""
)
```

이 경우 Compose는 LoginState가 불변임을 알고, 해당 객체가 변경되지 않으면 UI를 다시 그릴 필요가 없다는 것을 확신할 수 있습니다.

결론

@Immutable 어노테이션을 사용하면 Jetpack Compose가 해당 객체가 불변임을 인식하여, 불필요한 리렌더링을 방지하고 성능을 최적화할 수 있습니다. 이는 상태 변경이 빈번하지 않은 객체에 특히 유용하며, UI 렌더링 성능을 개선하는 데 중요한 역할을 합니다.